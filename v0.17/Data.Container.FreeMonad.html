<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- The free monad construction on containers</a>
<a id="151" class="Comment">------------------------------------------------------------------------</a>

<a id="225" class="Keyword">module</a> <a id="232" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a> <a id="257" class="Keyword">where</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Level.html" class="Module">Level</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a><a id="314" class="Symbol">;</a> <a id="316" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="321" class="Symbol">;</a> <a id="323" href="Data.Sum.Base.html#927" class="Function Operator">[_,_]′</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.Product.html" class="Module">Data.Product</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Data.Container.html" class="Module">Data.Container</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a> <a id="421" class="Keyword">using</a> <a id="427" class="Symbol">(</a><a id="428" href="Data.Container.Combinator.html#889" class="Function">const</a><a id="433" class="Symbol">;</a> <a id="435" href="Data.Container.Combinator.html#1676" class="Function Operator">_⊎_</a><a id="438" class="Symbol">)</a>
<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Data.W.html" class="Module">Data.W</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="487" class="Keyword">infixl</a> <a id="494" class="Number">1</a> <a id="496" href="Data.Container.FreeMonad.html#1385" class="Function Operator">_⋆C_</a>
<a id="501" class="Keyword">infix</a>  <a id="508" class="Number">1</a> <a id="510" href="Data.Container.FreeMonad.html#1470" class="Function Operator">_⋆_</a>

<a id="515" class="Comment">------------------------------------------------------------------------</a>

<a id="589" class="Comment">-- The free monad construction over a container and a set is, in</a>
<a id="654" class="Comment">-- universal algebra terminology, also known as the term algebra over a</a>
<a id="726" class="Comment">-- signature (a container) and a set (of variable symbols). The return</a>
<a id="797" class="Comment">-- of the free monad corresponds to variables and the bind operator</a>
<a id="865" class="Comment">-- corresponds to (parallel) substitution.</a>

<a id="909" class="Comment">-- A useful intuition is to think of containers describing single</a>
<a id="975" class="Comment">-- operations and the free monad construction over a container and a set</a>
<a id="1048" class="Comment">-- describing a tree of operations as nodes and elements of the set as</a>
<a id="1119" class="Comment">-- leafs. If one starts at the root, then any path will pass finitely</a>
<a id="1189" class="Comment">-- many nodes (operations described by the container) and eventually end</a>
<a id="1262" class="Comment">-- up in a leaf (element of the set) -- hence the Kleene star notation</a>
<a id="1333" class="Comment">-- (the type can be read as a regular expression).</a>

<a id="_⋆C_"></a><a id="1385" href="Data.Container.FreeMonad.html#1385" class="Function Operator">_⋆C_</a> <a id="1390" class="Symbol">:</a> <a id="1392" class="Symbol">∀</a> <a id="1394" class="Symbol">{</a><a id="1395" href="Data.Container.FreeMonad.html#1395" class="Bound">x</a> <a id="1397" href="Data.Container.FreeMonad.html#1397" class="Bound">s</a> <a id="1399" href="Data.Container.FreeMonad.html#1399" class="Bound">p</a><a id="1400" class="Symbol">}</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Data.Container.Core.html#386" class="Record">Container</a> <a id="1414" href="Data.Container.FreeMonad.html#1397" class="Bound">s</a> <a id="1416" href="Data.Container.FreeMonad.html#1399" class="Bound">p</a> <a id="1418" class="Symbol">→</a> <a id="1420" class="PrimitiveType">Set</a> <a id="1424" href="Data.Container.FreeMonad.html#1395" class="Bound">x</a> <a id="1426" class="Symbol">→</a> <a id="1428" href="Data.Container.Core.html#386" class="Record">Container</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Data.Container.FreeMonad.html#1397" class="Bound">s</a> <a id="1441" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1443" href="Data.Container.FreeMonad.html#1395" class="Bound">x</a><a id="1444" class="Symbol">)</a> <a id="1446" href="Data.Container.FreeMonad.html#1399" class="Bound">p</a>
<a id="1448" href="Data.Container.FreeMonad.html#1448" class="Bound">C</a> <a id="1450" href="Data.Container.FreeMonad.html#1385" class="Function Operator">⋆C</a> <a id="1453" href="Data.Container.FreeMonad.html#1453" class="Bound">X</a> <a id="1455" class="Symbol">=</a> <a id="1457" href="Data.Container.Combinator.html#889" class="Function">const</a> <a id="1463" href="Data.Container.FreeMonad.html#1453" class="Bound">X</a> <a id="1465" href="Data.Container.Combinator.html#1676" class="Function Operator">⊎</a> <a id="1467" href="Data.Container.FreeMonad.html#1448" class="Bound">C</a>

<a id="_⋆_"></a><a id="1470" href="Data.Container.FreeMonad.html#1470" class="Function Operator">_⋆_</a> <a id="1474" class="Symbol">:</a> <a id="1476" class="Symbol">∀</a> <a id="1478" class="Symbol">{</a><a id="1479" href="Data.Container.FreeMonad.html#1479" class="Bound">x</a> <a id="1481" href="Data.Container.FreeMonad.html#1481" class="Bound">s</a> <a id="1483" href="Data.Container.FreeMonad.html#1483" class="Bound">p</a><a id="1484" class="Symbol">}</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Data.Container.Core.html#386" class="Record">Container</a> <a id="1498" href="Data.Container.FreeMonad.html#1481" class="Bound">s</a> <a id="1500" href="Data.Container.FreeMonad.html#1483" class="Bound">p</a> <a id="1502" class="Symbol">→</a> <a id="1504" class="PrimitiveType">Set</a> <a id="1508" href="Data.Container.FreeMonad.html#1479" class="Bound">x</a> <a id="1510" class="Symbol">→</a> <a id="1512" class="PrimitiveType">Set</a> <a id="1516" class="Symbol">(</a><a id="1517" href="Data.Container.FreeMonad.html#1479" class="Bound">x</a> <a id="1519" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1521" href="Data.Container.FreeMonad.html#1481" class="Bound">s</a> <a id="1523" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1525" href="Data.Container.FreeMonad.html#1483" class="Bound">p</a><a id="1526" class="Symbol">)</a>
<a id="1528" href="Data.Container.FreeMonad.html#1528" class="Bound">C</a> <a id="1530" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1532" href="Data.Container.FreeMonad.html#1532" class="Bound">X</a> <a id="1534" class="Symbol">=</a> <a id="1536" href="Data.Container.html#1111" class="Function">μ</a> <a id="1538" class="Symbol">(</a><a id="1539" href="Data.Container.FreeMonad.html#1528" class="Bound">C</a> <a id="1541" href="Data.Container.FreeMonad.html#1385" class="Function Operator">⋆C</a> <a id="1544" href="Data.Container.FreeMonad.html#1532" class="Bound">X</a><a id="1545" class="Symbol">)</a>

<a id="1548" class="Keyword">module</a> <a id="1555" href="Data.Container.FreeMonad.html#1555" class="Module">_</a> <a id="1557" class="Symbol">{</a><a id="1558" href="Data.Container.FreeMonad.html#1558" class="Bound">s</a> <a id="1560" href="Data.Container.FreeMonad.html#1560" class="Bound">p</a><a id="1561" class="Symbol">}</a> <a id="1563" class="Symbol">{</a><a id="1564" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1566" class="Symbol">:</a> <a id="1568" href="Data.Container.Core.html#386" class="Record">Container</a> <a id="1578" href="Data.Container.FreeMonad.html#1558" class="Bound">s</a> <a id="1580" href="Data.Container.FreeMonad.html#1560" class="Bound">p</a><a id="1581" class="Symbol">}</a> <a id="1583" class="Keyword">where</a>

  <a id="1592" href="Data.Container.FreeMonad.html#1592" class="Function">inn</a> <a id="1596" class="Symbol">:</a> <a id="1598" class="Symbol">∀</a> <a id="1600" class="Symbol">{</a><a id="1601" href="Data.Container.FreeMonad.html#1601" class="Bound">x</a><a id="1602" class="Symbol">}</a> <a id="1604" class="Symbol">{</a><a id="1605" href="Data.Container.FreeMonad.html#1605" class="Bound">X</a> <a id="1607" class="Symbol">:</a> <a id="1609" class="PrimitiveType">Set</a> <a id="1613" href="Data.Container.FreeMonad.html#1601" class="Bound">x</a><a id="1614" class="Symbol">}</a> <a id="1616" class="Symbol">→</a> <a id="1618" href="Data.Container.Core.html#576" class="Function Operator">⟦</a> <a id="1620" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1622" href="Data.Container.Core.html#576" class="Function Operator">⟧</a> <a id="1624" class="Symbol">(</a><a id="1625" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1627" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1629" href="Data.Container.FreeMonad.html#1605" class="Bound">X</a><a id="1630" class="Symbol">)</a> <a id="1632" class="Symbol">→</a> <a id="1634" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1636" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1638" href="Data.Container.FreeMonad.html#1605" class="Bound">X</a>
  <a id="1642" href="Data.Container.FreeMonad.html#1592" class="Function">inn</a> <a id="1646" class="Symbol">(</a><a id="1647" href="Data.Container.FreeMonad.html#1647" class="Bound">s</a> <a id="1649" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1651" href="Data.Container.FreeMonad.html#1651" class="Bound">f</a><a id="1652" class="Symbol">)</a> <a id="1654" class="Symbol">=</a> <a id="1656" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1660" class="Symbol">(</a><a id="1661" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1666" href="Data.Container.FreeMonad.html#1647" class="Bound">s</a> <a id="1668" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1670" href="Data.Container.FreeMonad.html#1651" class="Bound">f</a><a id="1671" class="Symbol">)</a>

  <a id="1676" href="Data.Container.FreeMonad.html#1676" class="Function">rawMonad</a> <a id="1685" class="Symbol">:</a> <a id="1687" class="Symbol">∀</a> <a id="1689" class="Symbol">{</a><a id="1690" href="Data.Container.FreeMonad.html#1690" class="Bound">x</a><a id="1691" class="Symbol">}</a> <a id="1693" class="Symbol">→</a> <a id="1695" href="Category.Monad.html#360" class="Function">RawMonad</a> <a id="1704" class="Symbol">{</a><a id="1705" href="Data.Container.FreeMonad.html#1558" class="Bound">s</a> <a id="1707" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1709" href="Data.Container.FreeMonad.html#1560" class="Bound">p</a> <a id="1711" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1713" href="Data.Container.FreeMonad.html#1690" class="Bound">x</a><a id="1714" class="Symbol">}</a> <a id="1716" class="Symbol">(</a><a id="1717" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1719" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆_</a><a id="1721" class="Symbol">)</a>
  <a id="1725" href="Data.Container.FreeMonad.html#1676" class="Function">rawMonad</a> <a id="1734" class="Symbol">=</a> <a id="1736" class="Keyword">record</a> <a id="1743" class="Symbol">{</a> <a id="1745" href="Category.Monad.Indexed.html#533" class="Field">return</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Data.Container.FreeMonad.html#1792" class="Function">return</a><a id="1760" class="Symbol">;</a> <a id="1762" href="Category.Monad.Indexed.html#568" class="Field Operator">_&gt;&gt;=_</a> <a id="1768" class="Symbol">=</a> <a id="1770" href="Data.Container.FreeMonad.html#1859" class="Function Operator">_&gt;&gt;=_</a> <a id="1776" class="Symbol">}</a>
    <a id="1782" class="Keyword">where</a>
    <a id="1792" href="Data.Container.FreeMonad.html#1792" class="Function">return</a> <a id="1799" class="Symbol">:</a> <a id="1801" class="Symbol">∀</a> <a id="1803" class="Symbol">{</a><a id="1804" href="Data.Container.FreeMonad.html#1804" class="Bound">X</a><a id="1805" class="Symbol">}</a> <a id="1807" class="Symbol">→</a> <a id="1809" href="Data.Container.FreeMonad.html#1804" class="Bound">X</a> <a id="1811" class="Symbol">→</a> <a id="1813" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1815" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1817" href="Data.Container.FreeMonad.html#1804" class="Bound">X</a>
    <a id="1823" href="Data.Container.FreeMonad.html#1792" class="Function">return</a> <a id="1830" href="Data.Container.FreeMonad.html#1830" class="Bound">x</a> <a id="1832" class="Symbol">=</a> <a id="1834" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1838" class="Symbol">(</a><a id="1839" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="1844" href="Data.Container.FreeMonad.html#1830" class="Bound">x</a> <a id="1846" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1848" class="Symbol">λ</a> <a id="1850" class="Symbol">())</a>

    <a id="1859" href="Data.Container.FreeMonad.html#1859" class="Function Operator">_&gt;&gt;=_</a> <a id="1865" class="Symbol">:</a> <a id="1867" class="Symbol">∀</a> <a id="1869" class="Symbol">{</a><a id="1870" href="Data.Container.FreeMonad.html#1870" class="Bound">X</a> <a id="1872" href="Data.Container.FreeMonad.html#1872" class="Bound">Y</a><a id="1873" class="Symbol">}</a> <a id="1875" class="Symbol">→</a> <a id="1877" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1879" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1881" href="Data.Container.FreeMonad.html#1870" class="Bound">X</a> <a id="1883" class="Symbol">→</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Data.Container.FreeMonad.html#1870" class="Bound">X</a> <a id="1888" class="Symbol">→</a> <a id="1890" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1892" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1894" href="Data.Container.FreeMonad.html#1872" class="Bound">Y</a><a id="1895" class="Symbol">)</a> <a id="1897" class="Symbol">→</a> <a id="1899" href="Data.Container.FreeMonad.html#1564" class="Bound">C</a> <a id="1901" href="Data.Container.FreeMonad.html#1470" class="Function Operator">⋆</a> <a id="1903" href="Data.Container.FreeMonad.html#1872" class="Bound">Y</a>
    <a id="1909" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1913" class="Symbol">(</a><a id="1914" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="1919" href="Data.Container.FreeMonad.html#1919" class="Bound">x</a> <a id="1921" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1923" class="Symbol">_)</a> <a id="1926" href="Data.Container.FreeMonad.html#1859" class="Function Operator">&gt;&gt;=</a> <a id="1930" href="Data.Container.FreeMonad.html#1930" class="Bound">k</a> <a id="1932" class="Symbol">=</a> <a id="1934" href="Data.Container.FreeMonad.html#1930" class="Bound">k</a> <a id="1936" href="Data.Container.FreeMonad.html#1919" class="Bound">x</a>
    <a id="1942" href="Data.W.html#467" class="InductiveConstructor">sup</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="1952" href="Data.Container.FreeMonad.html#1952" class="Bound">s</a> <a id="1954" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1956" href="Data.Container.FreeMonad.html#1956" class="Bound">f</a><a id="1957" class="Symbol">)</a> <a id="1959" href="Data.Container.FreeMonad.html#1859" class="Function Operator">&gt;&gt;=</a> <a id="1963" href="Data.Container.FreeMonad.html#1963" class="Bound">k</a> <a id="1965" class="Symbol">=</a> <a id="1967" href="Data.Container.FreeMonad.html#1592" class="Function">inn</a> <a id="1971" class="Symbol">(</a><a id="1972" href="Data.Container.FreeMonad.html#1952" class="Bound">s</a> <a id="1974" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1976" class="Symbol">λ</a> <a id="1978" href="Data.Container.FreeMonad.html#1978" class="Bound">p</a> <a id="1980" class="Symbol">→</a> <a id="1982" href="Data.Container.FreeMonad.html#1956" class="Bound">f</a> <a id="1984" href="Data.Container.FreeMonad.html#1978" class="Bound">p</a> <a id="1986" href="Data.Container.FreeMonad.html#1859" class="Function Operator">&gt;&gt;=</a> <a id="1990" href="Data.Container.FreeMonad.html#1963" class="Bound">k</a><a id="1991" class="Symbol">)</a>
</pre></body></html>