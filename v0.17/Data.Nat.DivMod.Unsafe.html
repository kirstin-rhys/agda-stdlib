<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.DivMod.Unsafe</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- More efficient (and unsafe) mod and divMod operations</a>
<a id="163" class="Comment">------------------------------------------------------------------------</a>

<a id="237" class="Keyword">module</a> <a id="244" href="Data.Nat.DivMod.Unsafe.html" class="Module">Data.Nat.DivMod.Unsafe</a> <a id="267" class="Keyword">where</a>

<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="295" class="Keyword">using</a> <a id="301" class="Symbol">(</a><a id="302" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="303" class="Symbol">;</a> <a id="305" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+_</a><a id="308" class="Symbol">;</a> <a id="310" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">_*_</a><a id="313" class="Symbol">;</a> <a id="315" href="Data.Nat.Properties.html#1319" class="Function Operator">_≟_</a><a id="318" class="Symbol">;</a> <a id="320" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="324" class="Symbol">;</a> <a id="326" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a> <a id="359" class="Keyword">hiding</a> <a id="366" class="Symbol">(</a><a id="367" href="Data.Nat.DivMod.html#3201" class="Function Operator">_mod_</a><a id="372" class="Symbol">;</a> <a id="374" href="Data.Nat.DivMod.html#3322" class="Function Operator">_divMod_</a><a id="382" class="Symbol">)</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="416" class="Keyword">using</a> <a id="422" class="Symbol">(</a><a id="423" href="Data.Nat.Properties.html#8590" class="Function">≤⇒≤″</a><a id="427" class="Symbol">)</a>
<a id="429" class="Keyword">import</a> <a id="436" href="Data.Nat.Unsafe.html" class="Module">Data.Nat.Unsafe</a> <a id="452" class="Symbol">as</a> <a id="455" class="Module">NatUnsafe</a>
<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="486" class="Keyword">using</a> <a id="492" class="Symbol">(</a><a id="493" href="Data.Fin.Base.html#915" class="Datatype">Fin</a><a id="496" class="Symbol">;</a> <a id="498" href="Data.Fin.Base.html#1041" class="Function">toℕ</a><a id="501" class="Symbol">;</a> <a id="503" href="Data.Fin.Base.html#1568" class="Function">fromℕ≤″</a><a id="510" class="Symbol">)</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="544" class="Keyword">using</a> <a id="550" class="Symbol">(</a><a id="551" href="Data.Fin.Properties.html#4855" class="Function">toℕ-fromℕ≤″</a><a id="562" class="Symbol">)</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Function.html" class="Module">Function</a> <a id="585" class="Keyword">using</a> <a id="591" class="Symbol">(</a><a id="592" href="Function.html#1891" class="Function Operator">_$_</a><a id="595" class="Symbol">)</a>
<a id="597" class="Keyword">open</a> <a id="602" class="Keyword">import</a> <a id="609" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="636" class="Keyword">using</a> <a id="642" class="Symbol">(</a><a id="643" href="Relation.Nullary.Decidable.html#954" class="Function">False</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="702" class="Keyword">using</a> <a id="708" class="Symbol">(</a><a id="709" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="713" class="Symbol">;</a> <a id="715" href="Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="718" class="Symbol">;</a> <a id="720" href="Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="724" class="Symbol">;</a> <a id="726" class="Keyword">module</a> <a id="733" href="Relation.Binary.PropositionalEquality.html#3975" class="Module">≡-Reasoning</a><a id="744" class="Symbol">)</a>
<a id="746" class="Keyword">import</a> <a id="753" href="Relation.Binary.PropositionalEquality.TrustMe.html" class="Module">Relation.Binary.PropositionalEquality.TrustMe</a> <a id="799" class="Symbol">as</a> <a id="802" class="Module">TrustMe</a>
  <a id="812" class="Keyword">using</a> <a id="818" class="Symbol">(</a><a id="819" href="Relation.Binary.PropositionalEquality.TrustMe.html#818" class="Function">erase</a><a id="824" class="Symbol">)</a>

<a id="827" class="Keyword">open</a> <a id="832" href="Relation.Binary.PropositionalEquality.html#3975" class="Module">≡-Reasoning</a>

<a id="845" class="Keyword">infixl</a> <a id="852" class="Number">7</a> <a id="854" href="Data.Nat.DivMod.Unsafe.html#965" class="Function Operator">_mod_</a> <a id="860" href="Data.Nat.DivMod.Unsafe.html#1260" class="Function Operator">_divMod_</a>

<a id="870" class="Comment">------------------------------------------------------------------------</a>
<a id="943" class="Comment">-- Certified modulus</a>

<a id="_mod_"></a><a id="965" href="Data.Nat.DivMod.Unsafe.html#965" class="Function Operator">_mod_</a> <a id="971" class="Symbol">:</a> <a id="973" class="Symbol">(</a><a id="974" href="Data.Nat.DivMod.Unsafe.html#974" class="Bound">dividend</a> <a id="983" href="Data.Nat.DivMod.Unsafe.html#983" class="Bound">divisor</a> <a id="991" class="Symbol">:</a> <a id="993" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="994" class="Symbol">)</a> <a id="996" class="Symbol">{</a><a id="997" href="Data.Nat.DivMod.Unsafe.html#997" class="Bound">≢0</a> <a id="1000" class="Symbol">:</a> <a id="1002" href="Relation.Nullary.Decidable.html#954" class="Function">False</a> <a id="1008" class="Symbol">(</a><a id="1009" href="Data.Nat.DivMod.Unsafe.html#983" class="Bound">divisor</a> <a id="1017" href="Data.Nat.Properties.html#1319" class="Function Operator">≟</a> <a id="1019" class="Number">0</a><a id="1020" class="Symbol">)}</a> <a id="1023" class="Symbol">→</a> <a id="1025" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="1029" href="Data.Nat.DivMod.Unsafe.html#983" class="Bound">divisor</a>
<a id="1037" class="Symbol">(</a><a id="1038" href="Data.Nat.DivMod.Unsafe.html#1038" class="Bound">a</a> <a id="1040" href="Data.Nat.DivMod.Unsafe.html#965" class="Function Operator">mod</a> <a id="1044" class="Number">0</a><a id="1045" class="Symbol">)</a> <a id="1047" class="Symbol">{}</a>
<a id="1050" class="Symbol">(</a><a id="1051" href="Data.Nat.DivMod.Unsafe.html#1051" class="Bound">a</a> <a id="1053" href="Data.Nat.DivMod.Unsafe.html#965" class="Function Operator">mod</a> <a id="1057" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1061" href="Data.Nat.DivMod.Unsafe.html#1061" class="Bound">n</a><a id="1062" class="Symbol">)</a> <a id="1064" class="Symbol">=</a> <a id="1066" href="Data.Fin.Base.html#1568" class="Function">fromℕ≤″</a> <a id="1074" class="Symbol">(</a><a id="1075" href="Data.Nat.DivMod.Unsafe.html#1051" class="Bound">a</a> <a id="1077" href="Data.Nat.DivMod.html#953" class="Function Operator">%</a> <a id="1079" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1083" href="Data.Nat.DivMod.Unsafe.html#1061" class="Bound">n</a><a id="1084" class="Symbol">)</a> <a id="1086" class="Symbol">(</a><a id="1087" href="Data.Nat.Unsafe.html#347" class="Function">NatUnsafe.erase</a> <a id="1103" class="Symbol">(</a><a id="1104" href="Data.Nat.Properties.html#8590" class="Function">≤⇒≤″</a> <a id="1109" class="Symbol">(</a><a id="1110" href="Data.Nat.DivMod.html#1298" class="Function">a%n&lt;n</a> <a id="1116" href="Data.Nat.DivMod.Unsafe.html#1051" class="Bound">a</a> <a id="1118" href="Data.Nat.DivMod.Unsafe.html#1061" class="Bound">n</a><a id="1119" class="Symbol">)))</a>

<a id="1124" class="Comment">------------------------------------------------------------------------</a>
<a id="1197" class="Comment">-- Returns modulus and division result with correctness proof</a>

<a id="_divMod_"></a><a id="1260" href="Data.Nat.DivMod.Unsafe.html#1260" class="Function Operator">_divMod_</a> <a id="1269" class="Symbol">:</a> <a id="1271" class="Symbol">(</a><a id="1272" href="Data.Nat.DivMod.Unsafe.html#1272" class="Bound">dividend</a> <a id="1281" href="Data.Nat.DivMod.Unsafe.html#1281" class="Bound">divisor</a> <a id="1289" class="Symbol">:</a> <a id="1291" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1292" class="Symbol">)</a> <a id="1294" class="Symbol">{</a><a id="1295" href="Data.Nat.DivMod.Unsafe.html#1295" class="Bound">≢0</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="Relation.Nullary.Decidable.html#954" class="Function">False</a> <a id="1306" class="Symbol">(</a><a id="1307" href="Data.Nat.DivMod.Unsafe.html#1281" class="Bound">divisor</a> <a id="1315" href="Data.Nat.Properties.html#1319" class="Function Operator">≟</a> <a id="1317" class="Number">0</a><a id="1318" class="Symbol">)}</a> <a id="1321" class="Symbol">→</a>
           <a id="1334" href="Data.Nat.DivMod.html#3021" class="Record">DivMod</a> <a id="1341" href="Data.Nat.DivMod.Unsafe.html#1272" class="Bound">dividend</a> <a id="1350" href="Data.Nat.DivMod.Unsafe.html#1281" class="Bound">divisor</a>
<a id="1358" class="Symbol">(</a><a id="1359" href="Data.Nat.DivMod.Unsafe.html#1359" class="Bound">a</a> <a id="1361" href="Data.Nat.DivMod.Unsafe.html#1260" class="Function Operator">divMod</a> <a id="1368" class="Number">0</a><a id="1369" class="Symbol">)</a> <a id="1371" class="Symbol">{}</a>
<a id="1374" class="Symbol">(</a><a id="1375" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1377" href="Data.Nat.DivMod.Unsafe.html#1260" class="Function Operator">divMod</a> <a id="1384" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1388" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a><a id="1389" class="Symbol">)</a> <a id="1391" class="Symbol">=</a> <a id="1393" href="Data.Nat.DivMod.html#3077" class="InductiveConstructor">result</a> <a id="1400" class="Symbol">(</a><a id="1401" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1403" href="Data.Nat.DivMod.html#814" class="Function Operator">div</a> <a id="1407" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1411" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a><a id="1412" class="Symbol">)</a> <a id="1414" class="Symbol">(</a><a id="1415" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1417" href="Data.Nat.DivMod.Unsafe.html#965" class="Function Operator">mod</a> <a id="1421" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1425" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a><a id="1426" class="Symbol">)</a> <a id="1428" href="Function.html#1891" class="Function Operator">$</a> <a id="1430" href="Relation.Binary.PropositionalEquality.TrustMe.html#818" class="Function">TrustMe.erase</a> <a id="1444" href="Function.html#1891" class="Function Operator">$</a> <a id="1446" href="Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
  <a id="1454" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a>                                 <a id="1488" href="Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="1491" href="Data.Nat.DivMod.html#1146" class="Function">a≡a%n+[a/n]*n</a> <a id="1505" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1507" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a> <a id="1509" href="Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
  <a id="1513" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1515" href="Data.Nat.DivMod.html#953" class="Function Operator">%</a> <a id="1517" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1521" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a>              <a id="1536" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="1538" href="Data.Nat.DivMod.Unsafe.html#1691" class="Function">[a/n]*n</a>  <a id="1547" href="Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="1550" href="Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="1555" class="Symbol">(</a><a id="1556" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">_+</a> <a id="1559" href="Data.Nat.DivMod.Unsafe.html#1691" class="Function">[a/n]*n</a><a id="1566" class="Symbol">)</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Data.Fin.Properties.html#4855" class="Function">toℕ-fromℕ≤″</a> <a id="1586" href="Data.Nat.DivMod.Unsafe.html#1645" class="Function">lemma′</a><a id="1592" class="Symbol">))</a> <a id="1595" href="Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
  <a id="1599" href="Data.Fin.Base.html#1041" class="Function">toℕ</a> <a id="1603" class="Symbol">(</a><a id="1604" href="Data.Fin.Base.html#1568" class="Function">fromℕ≤″</a> <a id="1612" class="Symbol">_</a> <a id="1614" href="Data.Nat.DivMod.Unsafe.html#1645" class="Function">lemma′</a><a id="1620" class="Symbol">)</a> <a id="1622" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="1624" href="Data.Nat.DivMod.Unsafe.html#1691" class="Function">[a/n]*n</a>  <a id="1633" href="Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
  <a id="1637" class="Keyword">where</a>
  <a id="1645" href="Data.Nat.DivMod.Unsafe.html#1645" class="Function">lemma′</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="Data.Nat.Unsafe.html#347" class="Function">NatUnsafe.erase</a> <a id="1670" class="Symbol">(</a><a id="1671" href="Data.Nat.Properties.html#8590" class="Function">≤⇒≤″</a> <a id="1676" class="Symbol">(</a><a id="1677" href="Data.Nat.DivMod.html#1298" class="Function">a%n&lt;n</a> <a id="1683" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1685" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a><a id="1686" class="Symbol">))</a>
  <a id="1691" href="Data.Nat.DivMod.Unsafe.html#1691" class="Function">[a/n]*n</a> <a id="1699" class="Symbol">=</a> <a id="1701" href="Data.Nat.DivMod.Unsafe.html#1375" class="Bound">a</a> <a id="1703" href="Data.Nat.DivMod.html#814" class="Function Operator">div</a> <a id="1707" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1711" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a> <a id="1713" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="1715" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1719" href="Data.Nat.DivMod.Unsafe.html#1388" class="Bound">n</a>
</pre></body></html>