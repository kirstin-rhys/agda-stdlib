<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>README.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Example showing how the free monad construction on containers can be</a>
<a id="178" class="Comment">-- used</a>
<a id="186" class="Comment">------------------------------------------------------------------------</a>

<a id="260" class="Symbol">{-#</a> <a id="264" class="Keyword">OPTIONS</a> <a id="272" class="Pragma">--without-K</a> <a id="284" class="Pragma">--safe</a> <a id="291" class="Pragma">--sized-types</a> <a id="305" class="Symbol">#-}</a>

<a id="310" class="Keyword">module</a> <a id="317" href="README.Container.FreeMonad.html" class="Module">README.Container.FreeMonad</a> <a id="344" class="Keyword">where</a>

<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="423" class="Keyword">open</a> <a id="428" class="Keyword">import</a> <a id="435" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="450" class="Keyword">using</a> <a id="456" class="Symbol">(</a><a id="457" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a><a id="461" class="Symbol">;</a> <a id="463" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a><a id="467" class="Symbol">)</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="511" class="Keyword">using</a> <a id="517" class="Symbol">(</a><a id="518" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="528" class="Symbol">)</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Data.Product.html" class="Module">Data.Product</a> <a id="555" class="Keyword">renaming</a> <a id="564" class="Symbol">(</a><a id="565" href="Data.Product.html#1389" class="Function Operator">_×_</a> <a id="569" class="Symbol">to</a> <a id="572" href="Data.Product.html#1389" class="Function Operator">_⟨×⟩_</a><a id="577" class="Symbol">)</a>
<a id="579" class="Keyword">open</a> <a id="584" class="Keyword">import</a> <a id="591" href="Data.Container.html" class="Module">Data.Container</a>
<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a>
<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Data.W.html" class="Module">Data.W</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="750" class="Symbol">as</a> <a id="753" class="Module">P</a>

<a id="756" class="Comment">------------------------------------------------------------------------</a>

<a id="830" class="Comment">-- The signature of state and its (generic) operations.</a>

<a id="State"></a><a id="887" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="893" class="Symbol">:</a> <a id="895" class="PrimitiveType">Set</a> <a id="899" class="Symbol">→</a> <a id="901" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="911" class="Symbol">_</a> <a id="913" class="Symbol">_</a>
<a id="915" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="921" href="README.Container.FreeMonad.html#921" class="Bound">S</a> <a id="923" class="Symbol">=</a> <a id="925" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a> <a id="927" href="README.Container.FreeMonad.html#949" class="Function Operator">⟶</a> <a id="929" href="README.Container.FreeMonad.html#921" class="Bound">S</a> <a id="931" href="Data.Container.Combinator.html#1968" class="Function Operator">⊎</a> <a id="933" href="README.Container.FreeMonad.html#921" class="Bound">S</a> <a id="935" href="README.Container.FreeMonad.html#949" class="Function Operator">⟶</a> <a id="937" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
  <a id="941" class="Keyword">where</a>
  <a id="949" href="README.Container.FreeMonad.html#949" class="Function Operator">_⟶_</a> <a id="953" class="Symbol">:</a> <a id="955" class="PrimitiveType">Set</a> <a id="959" class="Symbol">→</a> <a id="961" class="PrimitiveType">Set</a> <a id="965" class="Symbol">→</a> <a id="967" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="977" class="Symbol">_</a> <a id="979" class="Symbol">_</a>
  <a id="983" href="README.Container.FreeMonad.html#983" class="Bound">I</a> <a id="985" href="README.Container.FreeMonad.html#949" class="Function Operator">⟶</a> <a id="987" href="README.Container.FreeMonad.html#987" class="Bound">O</a> <a id="989" class="Symbol">=</a> <a id="991" href="README.Container.FreeMonad.html#983" class="Bound">I</a> <a id="993" href="Data.Container.Core.html#617" class="InductiveConstructor Operator">▷</a> <a id="995" class="Symbol">λ</a> <a id="997" href="README.Container.FreeMonad.html#997" class="Bound">_</a> <a id="999" class="Symbol">→</a> <a id="1001" href="README.Container.FreeMonad.html#987" class="Bound">O</a>

<a id="get"></a><a id="1004" href="README.Container.FreeMonad.html#1004" class="Function">get</a> <a id="1008" class="Symbol">:</a> <a id="1010" class="Symbol">∀</a> <a id="1012" class="Symbol">{</a><a id="1013" href="README.Container.FreeMonad.html#1013" class="Bound">S</a><a id="1014" class="Symbol">}</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="1024" href="README.Container.FreeMonad.html#1013" class="Bound">S</a> <a id="1026" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1028" href="README.Container.FreeMonad.html#1013" class="Bound">S</a>
<a id="1030" href="README.Container.FreeMonad.html#1004" class="Function">get</a> <a id="1034" class="Symbol">=</a> <a id="1036" href="Data.Container.FreeMonad.html#1641" class="Function">inn</a> <a id="1040" class="Symbol">(</a><a id="1041" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1046" class="Symbol">_</a> <a id="1048" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1050" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1056" class="Symbol">)</a>
  <a id="1060" class="Keyword">where</a>
  <a id="1068" class="Keyword">open</a> <a id="1073" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1082" href="Data.Container.FreeMonad.html#1725" class="Function">rawMonad</a>

<a id="put"></a><a id="1092" href="README.Container.FreeMonad.html#1092" class="Function">put</a> <a id="1096" class="Symbol">:</a> <a id="1098" class="Symbol">∀</a> <a id="1100" class="Symbol">{</a><a id="1101" href="README.Container.FreeMonad.html#1101" class="Bound">S</a><a id="1102" class="Symbol">}</a> <a id="1104" class="Symbol">→</a> <a id="1106" href="README.Container.FreeMonad.html#1101" class="Bound">S</a> <a id="1108" class="Symbol">→</a> <a id="1110" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="1116" href="README.Container.FreeMonad.html#1101" class="Bound">S</a> <a id="1118" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1120" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="1122" href="README.Container.FreeMonad.html#1092" class="Function">put</a> <a id="1126" href="README.Container.FreeMonad.html#1126" class="Bound">s</a> <a id="1128" class="Symbol">=</a> <a id="1130" href="Data.Container.FreeMonad.html#1641" class="Function">inn</a> <a id="1134" class="Symbol">(</a><a id="1135" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1140" href="README.Container.FreeMonad.html#1126" class="Bound">s</a> <a id="1142" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1144" href="Category.Monad.Indexed.html#569" class="Function">return</a><a id="1150" class="Symbol">)</a>
  <a id="1154" class="Keyword">where</a>
  <a id="1162" class="Keyword">open</a> <a id="1167" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1176" href="Data.Container.FreeMonad.html#1725" class="Function">rawMonad</a>

<a id="1186" class="Comment">-- Using the above we can, for example, write a stateful program that</a>
<a id="1256" class="Comment">-- delivers a boolean.</a>
<a id="prog"></a><a id="1279" href="README.Container.FreeMonad.html#1279" class="Function">prog</a> <a id="1284" class="Symbol">:</a> <a id="1286" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="1292" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="1294" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1296" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a>
<a id="1301" href="README.Container.FreeMonad.html#1279" class="Function">prog</a> <a id="1306" class="Symbol">=</a>
  <a id="1310" href="README.Container.FreeMonad.html#1004" class="Function">get</a>         <a id="1322" href="Category.Monad.Indexed.html#604" class="Function Operator">&gt;&gt;=</a> <a id="1326" class="Symbol">λ</a> <a id="1328" href="README.Container.FreeMonad.html#1328" class="Bound">n</a> <a id="1330" class="Symbol">→</a>
  <a id="1334" href="README.Container.FreeMonad.html#1092" class="Function">put</a> <a id="1338" class="Symbol">(</a><a id="1339" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="1343" href="README.Container.FreeMonad.html#1328" class="Bound">n</a><a id="1344" class="Symbol">)</a> <a id="1346" href="Category.Monad.Indexed.html#666" class="Function Operator">&gt;&gt;</a>
  <a id="1351" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1358" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a>
  <a id="1365" class="Keyword">where</a>
  <a id="1373" class="Keyword">open</a> <a id="1378" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1387" href="Data.Container.FreeMonad.html#1725" class="Function">rawMonad</a>

<a id="runState"></a><a id="1397" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1406" class="Symbol">:</a> <a id="1408" class="Symbol">{</a><a id="1409" href="README.Container.FreeMonad.html#1409" class="Bound">S</a> <a id="1411" href="README.Container.FreeMonad.html#1411" class="Bound">X</a> <a id="1413" class="Symbol">:</a> <a id="1415" class="PrimitiveType">Set</a><a id="1418" class="Symbol">}</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="README.Container.FreeMonad.html#887" class="Function">State</a> <a id="1428" href="README.Container.FreeMonad.html#1409" class="Bound">S</a> <a id="1430" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1432" href="README.Container.FreeMonad.html#1411" class="Bound">X</a> <a id="1434" class="Symbol">→</a> <a id="1436" class="Symbol">(</a><a id="1437" href="README.Container.FreeMonad.html#1409" class="Bound">S</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="README.Container.FreeMonad.html#1411" class="Bound">X</a> <a id="1443" href="Data.Product.html#1389" class="Function Operator">⟨×⟩</a> <a id="1447" href="README.Container.FreeMonad.html#1409" class="Bound">S</a><a id="1448" class="Symbol">)</a>
<a id="1450" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1464" class="Symbol">(</a><a id="1465" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1470" href="README.Container.FreeMonad.html#1470" class="Bound">x</a> <a id="1472" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1474" class="Symbol">_))</a>        <a id="1485" class="Symbol">=</a> <a id="1487" class="Symbol">λ</a> <a id="1489" href="README.Container.FreeMonad.html#1489" class="Bound">s</a> <a id="1491" class="Symbol">→</a> <a id="1493" href="README.Container.FreeMonad.html#1470" class="Bound">x</a> <a id="1495" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1497" href="README.Container.FreeMonad.html#1489" class="Bound">s</a>
<a id="1499" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="1525" class="Symbol">_)</a> <a id="1528" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1530" href="README.Container.FreeMonad.html#1530" class="Bound">k</a><a id="1531" class="Symbol">))</a> <a id="1534" class="Symbol">=</a> <a id="1536" class="Symbol">λ</a> <a id="1538" href="README.Container.FreeMonad.html#1538" class="Bound">s</a> <a id="1540" class="Symbol">→</a> <a id="1542" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1551" class="Symbol">(</a><a id="1552" href="README.Container.FreeMonad.html#1530" class="Bound">k</a> <a id="1554" href="README.Container.FreeMonad.html#1538" class="Bound">s</a><a id="1555" class="Symbol">)</a> <a id="1557" href="README.Container.FreeMonad.html#1538" class="Bound">s</a>
<a id="1559" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1579" class="Symbol">(</a><a id="1580" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1585" href="README.Container.FreeMonad.html#1585" class="Bound">s</a><a id="1586" class="Symbol">)</a> <a id="1588" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1590" href="README.Container.FreeMonad.html#1590" class="Bound">k</a><a id="1591" class="Symbol">))</a> <a id="1594" class="Symbol">=</a> <a id="1596" class="Symbol">λ</a> <a id="1598" href="README.Container.FreeMonad.html#1598" class="Bound">_</a> <a id="1600" class="Symbol">→</a> <a id="1602" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1611" class="Symbol">(</a><a id="1612" href="README.Container.FreeMonad.html#1590" class="Bound">k</a> <a id="1614" class="Symbol">_)</a> <a id="1617" href="README.Container.FreeMonad.html#1585" class="Bound">s</a>

<a id="test"></a><a id="1620" href="README.Container.FreeMonad.html#1620" class="Function">test</a> <a id="1625" class="Symbol">:</a> <a id="1627" href="README.Container.FreeMonad.html#1397" class="Function">runState</a> <a id="1636" href="README.Container.FreeMonad.html#1279" class="Function">prog</a> <a id="1641" class="Number">0</a> <a id="1643" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1645" class="Symbol">(</a><a id="1646" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a> <a id="1651" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1653" class="Number">1</a><a id="1654" class="Symbol">)</a>
<a id="1656" href="README.Container.FreeMonad.html#1620" class="Function">test</a> <a id="1661" class="Symbol">=</a> <a id="1663" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">P.refl</a>

<a id="1671" class="Comment">-- It should be noted that @State S ⋆ X@ is not the state monad. If we</a>
<a id="1742" class="Comment">-- could quotient @State S ⋆ X@ by the seven axioms of state (see</a>
<a id="1808" class="Comment">-- Plotkin and Power&#39;s &quot;Notions of Computation Determine Monads&quot;, 2002)</a>
<a id="1880" class="Comment">-- then we would get the state monad.</a>
</pre></body></html>